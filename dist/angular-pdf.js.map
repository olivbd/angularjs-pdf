{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap a2849112711a9f92cbf9","webpack:///./src/angular-pdf.directive.js","webpack:///./src/angular-pdf.module.js","webpack:///external \"angular\""],"names":["NgPdf","$window","$document","$log","backingScale","ctx","canvas","getContext","dpr","devicePixelRatio","bsr","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","setCanvasDimensions","w","h","ratio","width","Math","floor","height","style","setTransform","initCanvas","element","angular","addClass","existingCanvas","find","length","append","replaceWith","restrict","scope","pdf","onerror","onload","onpagerender","onpassword","onprogress","link","attrs","renderTask","pdfLoaderTask","debug","pdfDoc","limitHeight","limitcanvasheight","createElement","hasOwnProperty","windowEl","css","on","$apply","scroll","scrollY","PDFJS","disableWorker","renderPage","_internalRenderTask","cancel","getPage","num","then","viewport","pageWidthScale","renderContext","scale","page","getViewport","clientRect","getBoundingClientRect","min","canvasContext","render","promise","isFunction","catch","log","reason","clearCanvas","clearRect","renderPDF","console","params","url","withCredentials","usecredentials","httpHeaders","getDocument","onProgress","progressData","onPassword","updatePasswordFn","passwordResponse","_pdfDoc","pageCount","numPages","error","$watch","newVal","oldVal","rotate","destroy","undefined","setAttribute","Pdf","module","directive","name"],"mappings":"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","file":"angular-pdf.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"angular\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"pdf\", [\"angular\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pdf\"] = factory(require(\"angular\"));\n\telse\n\t\troot[\"pdf\"] = factory(root[\"angular\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/angular-pdf.module.js\");\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a2849112711a9f92cbf9","export const NgPdf = ($window, $document, $log) => {\n  'ngInject';\n\n  const backingScale = canvas => {\n    const ctx = canvas.getContext('2d');\n    const dpr = $window.devicePixelRatio || 1;\n    const bsr = ctx.webkitBackingStorePixelRatio ||\n      ctx.mozBackingStorePixelRatio ||\n      ctx.msBackingStorePixelRatio ||\n      ctx.oBackingStorePixelRatio ||\n      ctx.backingStorePixelRatio || 1;\n\n    return dpr / bsr;\n  };\n\n  const setCanvasDimensions = (canvas, w, h) => {\n    const ratio = backingScale(canvas);\n    canvas.width = Math.floor(w * ratio);\n    canvas.height = Math.floor(h * ratio);\n    canvas.style.width = `${Math.floor(w)}px`;\n    canvas.style.height = `${Math.floor(h)}px`;\n    canvas.getContext('2d').setTransform(ratio, 0, 0, ratio, 0, 0);\n    return canvas;\n  };\n\n  const initCanvas = (element, canvas) => {\n    angular.element(canvas).addClass('rotate0');\n\n    const existingCanvas = element.find('canvas');\n    if (existingCanvas.length === 0) {\n      element.append(canvas);\n    }\n    else {\n      existingCanvas.replaceWith(canvas);\n    }\n  };\n\n  return {\n    restrict: 'E',\n    // templateUrl(element, attr) {\n    //   $log.log('attr', attr);\n    //   return attr.templateUrl ? attr.templateUrl : false;\n    // },\n    scope: {\n      pdf:          '=',\n      onerror:      '&?',\n      onload:       '&?',\n      onpagerender: '&?',\n      onpassword:   '&?',\n      onprogress:   '&?'\n    },\n    link(scope, element, attrs) {\n      let\n        renderTask = null,\n        pdfLoaderTask = null,\n        debug = false,\n        pdfDoc = null,\n        limitHeight = attrs.limitcanvasheight === '1';\n\n      const canvas = $document[0].createElement('canvas');\n      initCanvas(element, canvas);\n\n      debug = attrs.hasOwnProperty('debug') ? attrs.debug : false;\n\n      const\n        ctx = canvas.getContext('2d'),\n        windowEl = angular.element($window);\n\n      element.css('display', 'block');\n\n      windowEl.on('scroll', () => {\n        scope.$apply(() => {\n          scope.scroll = windowEl[0].scrollY;\n        });\n      });\n\n      PDFJS.disableWorker = true;\n\n      scope.renderPage = num => {\n        if (renderTask) {\n          renderTask._internalRenderTask.cancel();\n        }\n\n        pdfDoc.getPage(num).then(page => {\n          let viewport;\n          let pageWidthScale;\n          let renderContext;\n\n          if (scope.pdf.scale === 'page-fit') {\n            viewport = page.getViewport(1);\n            const clientRect = element[0].getBoundingClientRect();\n            pageWidthScale = clientRect.width / viewport.width;\n            if (limitHeight) {\n              pageWidthScale = Math.min(pageWidthScale, clientRect.height / viewport.height);\n            }\n            scope.pdf.scale = pageWidthScale;\n          }\n          viewport = page.getViewport(scope.pdf.scale);\n\n          setCanvasDimensions(canvas, viewport.width, viewport.height);\n\n          renderContext = {\n            canvasContext: ctx,\n            viewport\n          };\n\n          renderTask = page.render(renderContext);\n          renderTask.promise.then(() => {\n            if (angular.isFunction(scope.onpagerender)) {\n              scope.onpagerender();\n            }\n          }).catch(reason => {\n            $log.log(reason);\n          });\n        });\n      };\n\n      const clearCanvas = function () {\n        if (ctx) {\n          ctx.clearRect(0, 0, canvas.width, canvas.height);\n        }\n      };\n\n      const renderPDF = function () {\n        console.log('renderPDF');\n        clearCanvas();\n\n        const params = {\n          url: scope.pdf.url,\n          withCredentials: scope.pdf.usecredentials\n        };\n\n        if (scope.pdf.httpHeaders) {\n          params.httpHeaders = scope.pdf.httpHeaders;\n        }\n\n        if (scope.pdf.url && scope.pdf.url.length) {\n          pdfLoaderTask = PDFJS.getDocument(params);\n          pdfLoaderTask.onProgress = function (progressData) {\n            if (angular.isFunction(scope.onprogress)) {\n              scope.onprogress({progressData: progressData});\n            }\n          };\n\n          pdfLoaderTask.onPassword = function (updatePasswordFn, passwordResponse) {\n            if (angular.isFunction(scope.onpassword)) {\n              scope.onpassword({updatePasswordFn: updatePasswordFn, passwordResponse: passwordResponse});\n            }\n          };\n\n          pdfLoaderTask.then(\n            _pdfDoc => {\n              if (angular.isFunction(scope.onload)) {\n                scope.onload();\n              }\n\n              pdfDoc = _pdfDoc;\n              scope.renderPage(scope.pdf.page);\n\n              scope.$apply(() => {\n                scope.pdf.pageCount = _pdfDoc.numPages;\n              });\n            }, error => {\n              if (error) {\n                if (angular.isFunction(scope.onerror)) {\n                  scope.onerror({error: error});\n                }\n              }\n            }\n          );\n        }\n      };\n\n      scope.$watch('pdf.url', (newVal, oldVal) => {\n        if (newVal !== '') {\n          if (debug) {\n            $log.log('pdfUrl value change detected: ', scope.pdf.url);\n          }\n          scope.pdf.page = 1;\n          scope.pdf.rotate = 0;\n          if (pdfLoaderTask) {\n            pdfLoaderTask.destroy().then(() => {\n              renderPDF();\n            });\n          } else {\n            renderPDF();\n          }\n        }\n      });\n\n      scope.$watch('pdf.page', () => {\n        if (scope.pdf.page < 1 || !scope.pdf.page) {\n          scope.pdf.page = 1;\n        }\n        else if (scope.pdf.page > scope.pdf.pageCount) {\n          scope.pdf.page = scope.pdf.pageCount;\n        }\n        if (pdfDoc !== null) {\n          scope.renderPage(scope.pdf.page);\n        }\n      });\n\n      scope.$watch('pdf.rotate', () => {\n        if (scope.pdf.rotate !== undefined) {\n          canvas.setAttribute('class', 'rotate' + scope.pdf.rotate);\n        }\n      });\n\n      scope.$watch('pdf.scale', () => {\n        if (scope.pdf.scale && pdfDoc !== null) {\n          scope.renderPage(scope.pdf.page);\n        }\n      });\n\n    }\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/angular-pdf.directive.js","import angular from 'angular';\nimport { NgPdf } from './angular-pdf.directive'\n\nexport const Pdf = angular\n  .module('pdf', [])\n  .directive('ngPdf', NgPdf)\n  .name;\n\nexport default Pdf;\n\n\n\n// WEBPACK FOOTER //\n// ./src/angular-pdf.module.js","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"angular\"\n// module id = 0\n// module chunks = 0"],"sourceRoot":""}